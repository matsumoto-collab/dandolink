# DandoLink（yusystem） 致命的脅威シナリオ10選

本ドキュメントは、システムを崩壊させる可能性のある「最も効果的な攻撃方法（致命的なリスクや脆弱性）」をまとめたものです。これらはシステムの防御策（アーキテクチャ設計、セキュリティ設定、テスト、監視）を優先的に強化するための指針となります。

## 1. クレデンシャル（秘密情報）の再露出
一度起きたGoogle API KeyやRedisパスワードなどの漏洩事件の再発を狙う手法です。`.env`ファイルの管理ミスや、クライアントサイドへの環境変数の誤露出（`NEXT_PUBLIC_`の誤用）を監視し、漏洩したキーを用いてデータベースや外部APIを乗っ取り、莫大な金銭的被害（クラウド破産）を発生させます。

## 2. SupabaseのN+1問題によるデータベース過負荷
利益計算API等では修正されていますが、複雑なリレーションを持つ他の画面（カレンダーや案件マスターなど）に潜むN+1問題のクエリ非効率性を探し出し、大量のリクエストを送信します。これによりSupabaseのコネクションプールを枯渇させ、システム全体をサービス拒否（DoS）状態に陥らせます。

## 3. Row Level Security (RLS) の設定不備の悪用
Supabaseのコア機能であるRLSの設定において、ポリシーの条件指定の抜け穴（論理エラー）を特定します。認証をバイパス、あるいは権限の昇格を行い、他ユーザーの案件データや日報データをすべて窃取するか、勝手に削除・改ざんすることでデータインテグリティを破壊します。

## 4. PWAのキャッシュ暴走
導入されたPWAのService Workerにおけるキャッシュ戦略（`stale-while-revalidate` や `Cache First`）の設定ミスを突きます。古いバージョンのJavaScriptやAPIレスポンスが永遠にキャッシュされるように仕向け、新機能のリリースや重大なバグ修正のデプロイが行われても、ユーザー端末には決して反映されない「幽霊アプリ」化を引き起こします。

## 5. VercelのServerless Functionタイムアウト
PDFプレビュー生成や複雑な集計機能など、バックエンドの重い処理に対して集中的にリクエストを送ります。VercelのServerless Functionの実行時間制限（通常10〜60秒）を逆手に取り、意図的にタイムアウトエラー（504 Gateway Timeout）を頻発させてシステムの可用性を著しく低下させます。

## 6. 複雑なUIステートの矛盾（React/Zustand）
ドラッグ＆ドロップのカレンダー操作や、モーダルウィンドウのPC/スマホでの表示切り替えなど、複雑なフロントエンドの状態管理（React / Zustand）の限界を突きます。予期せぬタイミングでの連続クリックや、バックグラウンドでのタブ切り替えを行い、ステートを不整合に陥らせてブラウザをクラッシュさせます。

## 7. クロスブラウザ・デバイスごとの非互換性の増大
ChromeとEdgeの表示差異や、iOSでのPDFピンチズーム問題といったクロスブラウザでの脆弱性を利用します。あえて古いブラウザ、マイナーな環境、特殊な画面サイズの端末から操作を行い、意図的なレイアウト崩れやタッチイベントの不具合を引き起こし、ユーザー体験を損なわせます。

## 8. 不適切な画像・ファイルアップロードによるストレージ枯渇
案件マスター画像などのファイルアップロード機能において、ファイルサイズ制限や形式（MIMEタイプ）の検証が甘い箇所を攻撃します。数GBの悪意あるダミーファイルやスクリプトを偽装した画像を無制限に自動アップロードし、Supabase Storageの容量を一気にパンクさせます。

## 9. コンポーネントの再レンダリング地獄
`useProjects`などのカスタムフックや巨大なフォームコンポーネントにおいて、`useMemo`や`useCallback`の依存配列の設定ミス（Reactアンチパターン）を狙います。小さな文字入力などの軽微な操作でDOMツリー全体の再レンダリングが連鎖的に発生するよう仕向け、アプリの動作を極限まで重くし、クライアント端末のリソースを枯渇させます。

## 10. 「誰も全体を把握していない」属人化の進行
システムのビジネスロジックやインフラ設定が複雑化する中で、ドキュメント（`walkthrough.md`など）の更新漏れを放置させる、最も静かで致命的な攻撃です。時間をかけて「なぜ動いているのかわからないコード（ブラックボックス）」をシステム内に蓄積させ、将来的な保守を不可能にすることでプロジェクトを自壊させます。

---
**対策への第一歩**：
最大の敵からプロジェクトを守るためには、これらの脆弱性に対して「テストの自動化」「監視アラートの導入」「インフラ・フロントエンドの定期的なコードレビュー」「ドキュメントの継続的更新」を実行することが不可欠です。
